<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kinkty Demo 1.0.0</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet" />
  <style>
    body {
        font-family: 'Noto Sans TC', sans-serif;
        background-color: #121212;
        color: #ffffff;
    }
    .card {
        background-color: #1e1e1e;
        border: 1px solid #333;
        margin-bottom: 20px;
        color: #ffffff;
    }
    .btn-primary {
        background-color: #6f42c1;
        border-color: #6f42c1;
    }
    .progress {
        height: 20px;
    }
    .rejected-item {
        background-color: #c82333;
        padding: 5px;
        margin: 5px 0;
        border-radius: 4px;
    }
    .form-check-label, .form-label {
        color: #ffffff;
    }
    .slider-container {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-bottom: 1rem;
        word-break: break-word;
    }
    .slider-container label {
        font-weight: bold;
        margin-bottom: 0;
    }
    .slider-container input[type="range"] {
        width: 100%;
    }
    .slider-container span {
        display: inline-block;
        font-weight: bold;
        margin-top: 5px;
        padding: 5px 10px;
        border-radius: 4px;
    }
    .level-0 { color: #fff; background-color: #dc3545; }
    .level-1 { color: #fff; background-color: #e04b10; }
    .level-2 { color: #000; background-color: #ffc107; }
    .level-3 { color: #fff; background-color: #6c757d; }
    .level-4 { color: #fff; background-color: #28a745; }
    .level-5 { color: #fff; background-color: #791196; }

    .result-item {
      padding: 8px 12px;
      margin: 5px 0;
      border-radius: 6px;
      font-weight: bold;
    }
    .selected-button {
      background-color: #6f42c1 !important;
      color: #fff !important;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="mb-4 text-center">Kinkty Demo 1.0.0</h1>
    <div class="progress mb-4">
      <div id="progressBar" class="progress-bar" style="width: 10%;">æ­¥é©Ÿ 1 / 8</div>
    </div>

    <div id="page0" class="card p-4">
      <h2>æ­¡è¿ä½¿ç”¨ Kinktyï¼</h2>
      <p>é€™æ˜¯ä½œç‚ºBDSMå¯¦è¸å‰æºé€šå·¥å…·çš„ç¶²é ï¼Œå¦‚æœä½ è¦ºå¾—æœ‰äº›æ…¾æœ›ä¸å¥½èªªå‡ºå£ï¼Œæˆ–æ˜¯å£é ­æ‹’çµ•å°ä½ ä¾†èªªæœ‰äº›å£“åŠ›ï¼Œå¸Œæœ›Kinktyèƒ½å”åŠ©ä½ æºé€šæ›´é †æš¢ï¼</p>
      <ul>
        <p>ğŸŸªè«‹æŒ‰ç…§æ­¥é©Ÿå¡«å¯«ï¼Œä¸¦æŒ‰æŒ‡ç¤ºå°‡æ‰‹æ©Ÿ(è£ç½®)äº¤çµ¦æ‚¨çš„äº’å‹•å°è±¡å¡«å¯«ã€‚<p>
        <p>ğŸŸªæœ¬ç¶²é å°‡å”åŠ©é›™æ–¹ç¢ºèªæœŸå¾…å¯¦è¸çš„é …ç›®ã€é å‚™å¯¦è¸é …ç›®çš„å–œå¥½ç¨‹åº¦ï¼Œä»¥åŠçµ•å°ç¦æ­¢å¯¦è¸çš„ç¡¬åº•ç·šï¼Œç†è§£å½¼æ­¤çš„æ…¾æœ›å’Œç¦å¿Œ</li>
        <p>ğŸš«æœ¬ç¶²ç«™å«æœ‰æˆäººå…§å®¹ï¼Œæœªæ»¿18æ­²è«‹å‹¿é€ è¨ª<p>
        <p>âš ï¸Kinktyã€Œä¸æœƒå„²å­˜ã€æ‚¨å¡«å¯«çš„è³‡æ–™ï¼Œè«‹å–„ç”¨æ‰‹æ©Ÿæˆªåœ–ä¿å­˜æºé€šçµæœï¼Œç¶²é é‡æ•´å°‡å…¨éƒ¨æ¸…é™¤<p>
      </ul>
      <p>BDSMå¯¦è¸èˆ‡æ€§è¡Œç‚ºå‰/é€²è¡Œä¸­ï¼Œè«‹éµå®ˆçŸ¥æƒ…åŒæ„ç­‰åŸºæœ¬åŸå‰‡ç¢ºèªé›™æ–¹åˆæ„ç‹€æ…‹ã€‚</p>
      <p>æœ‰é—œKinktyä»»ä½•å•é¡Œæˆ–ä½¿ç”¨å»ºè­°ï¼Œæ­¡è¿è¯çµ¡X.com/@Tom_puppy444</p>
      <button class="btn btn-primary" onclick="goToSafetyCheck()">æˆ‘å·²æ»¿18æ­²ï¼ŒåŒæ„ä½¿ç”¨è¦ç¯„</button>
    </div>

    <div id="page1" class="card p-4 d-none">
      <h2>é›™æ–¹å·²ç¶“ç´„å®šï¼Œä¸¦ä¸”æ˜ç¢ºçŸ¥é“å®‰å…¨è©å—ï¼Ÿ</h2>
      <p>åŒ…æ‹¬ç„¡æ³•é€²è¡Œè¨€èªè¡¨é”æ™‚çš„è‚¢é«”å®‰å…¨è©</p>
      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-outline-light flex-fill" id="btnActiveConfirmed" onclick="toggleSafetyConfirm('active')">ä¸»å‹•æ–¹å·²ç¢ºèª</button>
        <button class="btn btn-outline-light flex-fill" id="btnPassiveConfirmed" onclick="toggleSafetyConfirm('passive')">è¢«å‹•æ–¹å·²ç¢ºèª</button>
      </div>
      <div class="mt-3">
        <button class="btn btn-primary" id="btnSafetyNext" onclick="confirmSafetyCheck()" disabled>ä¸‹ä¸€æ­¥</button>
      </div>
    </div>

    <div id="page2" class="card p-4 d-none">
      <h2>è«‹äº¤ç”±ä¸»å‹•æ–¹å¡«ç­”</h2>
      <button class="btn btn-primary" onclick="confirmIntro()">ç¢ºå®š</button>
    </div>

    <div id="page3" class="card p-4 d-none">
      <h2>ä¸»å‹•æ–¹å¡«ç­”</h2>
      <p>è«‹é¸æ“‡æ‚¨æƒ³å¯¦è¸æˆ–æ–°å¢çš„ BDSM é …ç›®ï¼š</p>
      <div id="options"></div>
      <div class="input-group mt-3">
        <input type="text" class="form-control" id="newItem" placeholder="æ–°å¢é …ç›®" />
        <button class="btn btn-outline-light" onclick="addItem()">æ–°å¢</button>
      </div>
      <button class="btn btn-primary mt-3" onclick="confirmSelection()">ç¢ºèªé¸æ“‡</button>
    </div>

    <div id="page4" class="card p-4 d-none">
      <h2>ä¸»å‹•æ–¹ç¦å¿Œ(ç¡¬åº•ç·š)</h2>
      <p>è«‹è¼¸å…¥æ‚¨çš„ç¦å¿Œ(ç¡¬åº•ç·š)ï¼š</p>
      <input type="text" class="form-control" id="activeHardLimit" />
      <button class="btn btn-primary mt-3" onclick="confirmActiveHardLimit()">ç¢ºèª</button>
    </div>

    <div id="page5" class="card p-4 d-none">
      <h2>è«‹äº¤ç”±è¢«å‹•æ–¹å¡«ç­”</h2>
      <button class="btn btn-primary" onclick="confirmPage2Intro()">ç¢ºå®š</button>
    </div>

    <div id="page6" class="card p-4 d-none">
      <h2>è¢«å‹•æ–¹å¡«ç­”</h2>
      <p>è«‹é¸æ“‡å„é …ç›®çš„å…è¨±ç¨‹åº¦ï¼ˆ0-5ï¼‰ï¼š</p>
      <div id="allowance"></div>
      <button class="btn btn-primary mt-3" onclick="confirmAllowance()">ç¢ºèª</button>
    </div>

    <div id="page7" class="card p-4 d-none">
      <h2>è¢«å‹•æ–¹ç¦å¿Œ(ç¡¬åº•ç·š)</h2>
      <p>è«‹è¼¸å…¥æ‚¨çš„ç¦å¿Œ(ç¡¬åº•ç·š)ï¼š</p>
      <input type="text" class="form-control" id="passiveHardLimit" />
      <button class="btn btn-primary mt-3" onclick="confirmPassiveHardLimit()">ç¢ºèª</button>
    </div>

    <div id="page7_5" class="card p-4 d-none">
      <h2>è¢«å‹•æ–¹è¨±é¡˜æ± </h2>
      <p>è«‹é¸æ“‡/å¡«å¯«æœŸå¾…ä¸»å‹•æ–¹å¯ä»¥å¯¦è¸çš„é …ç›®/è‡ªå·±æƒ³å°ä¸»å‹•æ–¹åšçš„é …ç›®/å…¶ä»–å¯¦è¸å‚™è¨»</p>
      <div id="expectationOptions"></div>
      <div class="input-group mt-3">
        <input type="text" class="form-control" id="newExpectationItem" placeholder="æ–°å¢æœŸå¾…é …ç›®" />
        <button class="btn btn-outline-light" onclick="addExpectationItem()">æ–°å¢</button>
      </div>
      <div class="mt-3">
        <h5>å·²é¸æ“‡çš„é …ç›®ï¼š</h5>
        <div id="selectedExpectations" class="text-info"></div>
      </div>
      <button class="btn btn-primary mt-3" onclick="confirmPassiveExpectation()">ç¢ºèª</button>
    </div>

    <div id="page8" class="card p-4 d-none">
      <h2>æœ€çµ‚çµæœ</h2>
      <pre id="finalResult" class="text-white" style="font-family: 'Noto Sans TC', sans-serif; font-size: 1.1em; white-space: pre-wrap;"></pre>
      <h4 id="rejectedTitle" class="text-danger d-none">ä»¥ä¸‹æ˜¯è¢«æ‹’çµ•çš„é …ç›®ï¼Œçµ•å°ç¦æ­¢å¯¦è¸ï¼š</h4>
      <div id="rejectedItems"></div>
    </div>
  </div>

  <script>
    let currentStep = 1;
    let totalSteps = 9;
    let safetyConfirm = { active: false, passive: false };
    let items = ["SPå±è‚¡", "SPå¤§è…¿", "TK", "ç¢°è§¸èƒ¸éƒ¨", "ç¢°è§¸å±è‚¡", "è„«ä¸Šè¡£è‡³èµ¤è£¸", "è„«å…§è¤²è‡³èµ¤è£¸", "å·´æŒ"];
    let selectedItems = new Set();
    let activeHardLimit = "";
    let passiveHardLimit = "";
    let passiveExpectation = "";
    let expectationItems = ["æƒ³ç•¶Brat","æƒ³å’¬äºº","æƒ³è¢«å’¬","è„†çš®SPè¼•ä¸€é»","å–œæ­¡æº«æŸ”tk"];
    let selectedExpectations = new Set();
    let allowanceLevels = {};
    const descriptions = ["çµ•å°ç¦æ­¢(ç¡¬åº•ç·š)", "ä¸å–œæ­¡ä½†å‹‰å¼·æ¥å—(è»Ÿåº•ç·š)", "ä¸å¤ªå–œæ­¡ä½†å¯æ¥å—", "æ²’ç‰¹åˆ¥æ„Ÿè¦º", "å¾ˆå–œæ­¡", "è¶…ç´šå–œæ­¡"];

    function setProgress(step) {
      const percent = (step / totalSteps) * 100;
      document.getElementById("progressBar").style.width = `${percent}%`;
      document.getElementById("progressBar").textContent = `æ­¥é©Ÿ ${step} / ${totalSteps}`;
    }

    function goToSafetyCheck() {
      document.getElementById("page0").classList.add("d-none");
      document.getElementById("page1").classList.remove("d-none");
      setProgress(2);
    }

    function toggleSafetyConfirm(role) {
      safetyConfirm[role] = !safetyConfirm[role];
      document.getElementById(`btn${role.charAt(0).toUpperCase() + role.slice(1)}Confirmed`).classList.toggle("selected-button", safetyConfirm[role]);
      document.getElementById("btnSafetyNext").disabled = !(safetyConfirm.active && safetyConfirm.passive);
    }

    function confirmSafetyCheck() {
      document.getElementById("page1").classList.add("d-none");
      document.getElementById("page2").classList.remove("d-none");
      setProgress(3);
    }

    function confirmIntro() {
      document.getElementById("page2").classList.add("d-none");
      document.getElementById("page3").classList.remove("d-none");
      renderOptions();
      setProgress(4);
    }

    function addItem() {
      let newItem = document.getElementById("newItem").value.trim();
      if (newItem && !items.includes(newItem)) {
        items.push(newItem);
        document.getElementById("newItem").value = "";
        renderOptions();
      }
    }

    function renderOptions() {
      let optionsDiv = document.getElementById("options");
      optionsDiv.innerHTML = "";
      items.forEach(item => {
        let div = document.createElement("div");
        div.className = "form-check";
        let checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.className = "form-check-input";
        checkbox.value = item;
        checkbox.id = `chk_${item}`;
        if (selectedItems.has(item)) checkbox.checked = true;
        checkbox.onchange = function() {
          if (this.checked) selectedItems.add(this.value);
          else selectedItems.delete(this.value);
        };
        let label = document.createElement("label");
        label.className = "form-check-label";
        label.htmlFor = `chk_${item}`;
        label.textContent = item;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
    }

    function confirmSelection() {
      if (selectedItems.size === 0) {
        alert("è«‹é¸æ“‡è‡³å°‘ä¸€é …ã€‚");
        return;
      }
      document.getElementById("page3").classList.add("d-none");
      document.getElementById("page4").classList.remove("d-none");
      setProgress(5);
    }

    function confirmActiveHardLimit() {
      activeHardLimit = document.getElementById("activeHardLimit").value;
      document.getElementById("page4").classList.add("d-none");
      document.getElementById("page5").classList.remove("d-none");
      setProgress(6);
    }

    function confirmPage2Intro() {
      document.getElementById("page5").classList.add("d-none");
      document.getElementById("page6").classList.remove("d-none");
      renderAllowance();
      setProgress(7);
    }

    function renderAllowance() {
      let allowanceDiv = document.getElementById("allowance");
      allowanceDiv.innerHTML = "";
      selectedItems.forEach(item => {
        let container = document.createElement("div");
        container.className = "slider-container";
        let label = document.createElement("label");
        label.textContent = item;
        let slider = document.createElement("input");
        slider.type = "range";
        slider.min = 0;
        slider.max = 5;
        slider.step = 1;
        slider.value = 3;
        slider.dataset.item = item;
        slider.className = "form-range";
        slider.oninput = function() {
          updateSliderValue(this);
        };
        let span = document.createElement("span");
        span.textContent = descriptions[3];
        span.classList.add('level-3');
        container.appendChild(label);
        container.appendChild(slider);
        container.appendChild(span);
        allowanceDiv.appendChild(container);
      });
    }

    function updateSliderValue(slider) {
      const span = slider.nextElementSibling;
      const level = slider.value;
      span.classList.remove("level-0", "level-1", "level-2", "level-3", "level-4", "level-5");
      span.classList.add(`level-${level}`);
      span.textContent = descriptions[level];
    }
    function confirmAllowance() {
      document.querySelectorAll("#allowance input").forEach(input => {
        allowanceLevels[input.dataset.item] = input.value;
      });
      document.getElementById("page6").classList.add("d-none");
      document.getElementById("page7").classList.remove("d-none");
      setProgress(8);
    }

    function confirmPassiveHardLimit() {
      passiveHardLimit = document.getElementById("passiveHardLimit").value;
      document.getElementById("page7").classList.add("d-none");
      document.getElementById("page7_5").classList.remove("d-none");
      renderExpectationOptions();
      setProgress(9);
    }

    function addExpectationItem() {
      let newItem = document.getElementById("newExpectationItem").value.trim();
      if (newItem && !expectationItems.includes(newItem)) {
        expectationItems.push(newItem);
        document.getElementById("newExpectationItem").value = "";
        renderExpectationOptions();
      }
    }

    function renderExpectationOptions() {
      let optionsDiv = document.getElementById("expectationOptions");
      optionsDiv.innerHTML = "";
      expectationItems.forEach(item => {
        let div = document.createElement("div");
        div.className = "form-check";
        let checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.className = "form-check-input";
        checkbox.value = item;
        checkbox.id = `chk_exp_${item}`;
        if (selectedExpectations.has(item)) checkbox.checked = true;
        checkbox.onchange = function() {
          if (this.checked) {
            selectedExpectations.add(this.value);
          } else {
            selectedExpectations.delete(this.value);
          }
          updateSelectedExpectations();
        };
        let label = document.createElement("label");
        label.className = "form-check-label";
        label.htmlFor = `chk_exp_${item}`;
        label.textContent = item;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
      updateSelectedExpectations();
    }

    function updateSelectedExpectations() {
      let selectedDiv = document.getElementById("selectedExpectations");
      if (selectedExpectations.size === 0) {
        selectedDiv.innerHTML = "<em>å°šæœªé¸æ“‡ä»»ä½•é …ç›®</em>";
      } else {
        selectedDiv.innerHTML = Array.from(selectedExpectations).map(item => `â€¢ ${item}`).join("<br>");
      }
    }

    function confirmPassiveExpectation() {
      passiveExpectation = Array.from(selectedExpectations).join("ã€");
      document.getElementById("page7_5").classList.add("d-none");
      document.getElementById("page8").classList.remove("d-none");
      showFinalResult();
    }

    function showFinalResult() {
      let rejectedItemsHtml = "";
      let hasRejectedItems = false;

      let categorizedItems = {
        5: [], 4: [], 3: [], 2: [], 1: [], 0: []
      };

      for (let [item, level] of Object.entries(allowanceLevels)) {
        categorizedItems[level].push(item);
      }

      let allowanceResultHtml = "";

      for (let level = 5; level >= 1; level--) {
        if (categorizedItems[level].length > 0) {
          allowanceResultHtml += `
            <div style="margin-top: 4px;">
              <strong class="level-${level}">${descriptions[level]}ï¼š</strong><br>`;
          categorizedItems[level].forEach(item => {
            allowanceResultHtml += `<span class="level-${level}">â€¢ ${item}</span><br>`;
          });
          allowanceResultHtml += `</div>`;
        }
      }

      if (categorizedItems[0].length > 0) {
        categorizedItems[0].forEach(item => {
          rejectedItemsHtml += `<div class="rejected-item">${item} - çµ•å°ç¦æ­¢</div>`;
        });
        hasRejectedItems = true;
      }

      const noLimitText = "<em>ï¼ˆæœªè¼¸å…¥ç¦å¿Œï¼Œè«‹é›™æ–¹å‹™å¿…ç¢ºèªï¼‰</em>";
      const activeLimitDisplay = activeHardLimit.trim() === "" ? noLimitText : activeHardLimit;
      const passiveLimitDisplay = passiveHardLimit.trim() === "" ? noLimitText : passiveHardLimit;

      let expectationListHtml = "<em>ï¼ˆç„¡è³‡æ–™ï¼‰</em>";
      if (selectedExpectations.size > 0) {
        expectationListHtml = "<ul style='padding-left: 1.2rem; margin-bottom: 0;'>";
        selectedExpectations.forEach(item => {
          expectationListHtml += `<li>${item}</li>`;
        });
        expectationListHtml += "</ul>";
      }

      document.getElementById("finalResult").outerHTML = `
        <div id="finalResult" class="text-white" style="font-family: 'Noto Sans TC', sans-serif; font-size: 1.05em; line-height: 1.5;">
          <div class="rejected-item" style="margin-bottom: 6px;"><strong>ä¸»å‹•æ–¹çš„ç¡¬åº•ç·šï¼š</strong> ${activeLimitDisplay}</div>
          <div class="rejected-item" style="margin-bottom: 6px;"><strong>è¢«å‹•æ–¹çš„ç¡¬åº•ç·šï¼š</strong> ${passiveLimitDisplay}</div>
          <div style="margin-top: 4px;"><strong>è¢«å‹•æ–¹æœŸå¾…ä¸»å‹•æ–¹å¯¦è¸é …ç›®ï¼š</strong><br>${expectationListHtml}</div>
          <div style="margin-top: 4px;"><strong>å…è¨±ç¨‹åº¦åˆ†é¡ï¼š</strong></div>
          ${allowanceResultHtml}
        </div>
      `;

      if (hasRejectedItems) {
        document.getElementById("rejectedTitle").classList.remove("d-none");
        document.getElementById("rejectedItems").innerHTML = rejectedItemsHtml;
      } else {
        document.getElementById("rejectedTitle").classList.add("d-none");
        document.getElementById("rejectedItems").innerHTML = "";
      }
    }
  </script>
</body>
</html>
